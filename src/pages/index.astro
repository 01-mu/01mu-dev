---
import BaseLayout from "../layouts/BaseLayout.astro";
import AuthorCard from "../components/AuthorCard.astro";
import { getVisiblePosts } from "../utils/posts";

const posts = await getVisiblePosts();
---

<BaseLayout description="Quiet notes for long-form thinking.">
  <div class="home-layout">
    <section class="home-content">
      <h1 class="page-title">Latest writing</h1>
      {posts.length === 0 ? (
        <p class="prose-meta">No published posts yet.</p>
      ) : (
        <ul class="post-list">
          {posts.map((post) => (
            <li>
              <a class="title" href={`/posts/${post.slug}`}>{post.data.title}</a>
              <div class="meta">
                {post.data.date.toLocaleDateString("en-US", {
                  year: "numeric",
                  month: "short",
                  day: "numeric",
                })}
                {post.data.tags.length > 0 && (
                  <span>
                    {" Â· "}
                    {post.data.tags.join(", ")}
                  </span>
                )}
              </div>
            </li>
          ))}
        </ul>
      )}
    </section>
    <aside class="home-sidebar">
      <AuthorCard />
    </aside>
  </div>
</BaseLayout>
